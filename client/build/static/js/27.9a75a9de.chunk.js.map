{"version":3,"sources":["components/shared/Posts.jsx","components/shared/UpdatePost.jsx"],"names":["axios","require","Posts","postLimit","useState","posts","setPosts","postsError","setPostsError","deleting","setDeleting","showDelDialog","setShowDelDialog","delPostId","setDelPostId","handleClose","displayUpdatePost","setDisplayUpdatePost","useEffect","get","then","response","data","status","reverse","filter","post","type","slice","show","onHide","Header","closeButton","Title","Body","Footer","variant","onClick","id","delete","catch","err","console","log","style","minHeight","className","map","index","src","featuredImage","rounded","width","height","title","featuredDesc","createdAt","split","comments","length","cursor","renderUpdatePost","backgroundColor","_id","UpdatePost","currentUserId","document","cookie","forEach","cookieString","currentUser","setCurrentUser","user","createdBy","creator","body","postBody","setPostBody","submitting","setSubmitting","postTitle","setPostTitle","postType","setPostType","featuredImg","setFeaturedImg","audio","audioLink","setAudioLink","setFeaturedDesc","Date","programmeDate","setProgrammeDate","updatePostError","setUpdatePostError","updatedPost","setUpdatedPost","notImage","setNotImage","canPublish","users","role","admin","dataObj","notifications","suggestion","Heading","onSubmit","e","extension","preventDefault","toLowerCase","name","postData","FormData","append","headers","xs","Group","controlId","Control","placeholder","required","value","onChange","target","Select","Label","selected","date","showTimeSelect","timeIntervals","dateFormat","accept","files","theme","as","size","animation"],"mappings":"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","file":"static/js/27.9a75a9de.chunk.js","sourcesContent":["import { useState, useEffect } from \"react\";\r\nimport Image from \"react-bootstrap/esm/Image\";\r\nimport Alert from \"react-bootstrap/esm/Alert\";\r\nimport Modal from \"react-bootstrap/esm/Modal\";\r\nimport Button from \"react-bootstrap/esm/Button\";\r\nimport Loader from \"./Loader\";\r\nimport UpdatePost from \"./UpdatePost\";\r\nconst axios = require(\"axios\");\r\n\r\nconst Posts = ({ postLimit }) => {\r\n  const [posts, setPosts] = useState(null);\r\n  const [postsError, setPostsError] = useState(null);\r\n  const [deleting, setDeleting] = useState(false);\r\n  const [showDelDialog, setShowDelDialog] = useState(false);\r\n  const [delPostId, setDelPostId] = useState(\"\");\r\n  const handleClose = () => setShowDelDialog(false);\r\n  const handleShow = () => setShowDelDialog(true);\r\n  const [displayUpdatePost, setDisplayUpdatePost] = useState(null);\r\n\r\n  const renderUpdatePost = (post) => {\r\n    setDisplayUpdatePost(post);\r\n  };\r\n\r\n  const deletePostHandler = (id) => {\r\n    setDeleting(true);\r\n    axios\r\n      .delete(`/posts/${id}`)\r\n      .then((response) => {\r\n        axios.get(\"/posts\").then((response) => {\r\n          if (!response.data) {\r\n            setPostsError(\"Error getting posts\");\r\n          } else if (!response.data.status) {\r\n            setPostsError(\"No post created yet... Add new\");\r\n          } else {\r\n            setDeleting(false);\r\n            if (postLimit) {\r\n              setPosts(\r\n                response.data.posts\r\n                  .reverse()\r\n                  .filter((post) => post.type !== \"airProgramme\")\r\n                  .slice(0, postLimit)\r\n              );\r\n            } else {\r\n              setPosts(\r\n                response.data.posts\r\n                  .reverse()\r\n                  .filter((post) => post.type !== \"airProgramme\")\r\n              );\r\n            }\r\n          }\r\n        });\r\n      })\r\n      .catch((err) => console.log(err));\r\n    handleClose();\r\n  };\r\n\r\n  useEffect(() => {\r\n    axios.get(\"/posts\").then((response) => {\r\n      if (!response.data) {\r\n        setPostsError(\"Error getting posts\");\r\n      } else if (!response.data.status) {\r\n        setPostsError(\"No post created yet... Add new\");\r\n      } else {\r\n        if (postLimit) {\r\n          setPosts(\r\n            response.data.posts\r\n              .reverse()\r\n              .filter((post) => post.type !== \"airProgramme\")\r\n              .slice(0, postLimit)\r\n          );\r\n        } else {\r\n          setPosts(\r\n            response.data.posts\r\n              .reverse()\r\n              .filter((post) => post.type !== \"airProgramme\")\r\n          );\r\n        }\r\n      }\r\n    });\r\n  }, [postLimit]);\r\n\r\n  return (\r\n    <div>\r\n      <Modal show={showDelDialog} onHide={handleClose}>\r\n        <Modal.Header closeButton>\r\n          <Modal.Title>Delete Post</Modal.Title>\r\n        </Modal.Header>\r\n        <Modal.Body>Woohoo, Do you want to delete post?</Modal.Body>\r\n        <Modal.Footer>\r\n          <Button variant=\"secondary\" onClick={handleClose}>\r\n            Not at all\r\n          </Button>\r\n          <Button variant=\"danger\" onClick={() => deletePostHandler(delPostId)}>\r\n            Yes, delete post\r\n          </Button>\r\n        </Modal.Footer>\r\n      </Modal>\r\n\r\n      {posts && !displayUpdatePost ? (\r\n        <section\r\n          style={{ minHeight: \"80px\" }}\r\n          className=\"bg-white px-3 py-4 me-md-2 my-3 rounded-3 shadow\"\r\n        >\r\n          <h4>Recent Posts</h4>\r\n          {deleting && <Loader />}\r\n          <table className=\"table\">\r\n            <thead>\r\n              <tr>\r\n                <th className=\"d-none d-md-table-cell\">No</th>\r\n                <th>Post Title</th>\r\n                <th className=\"d-none d-md-table-cell\">Type</th>\r\n                <th className=\"d-none d-md-table-cell\">Date</th>\r\n                <th className=\"d-none d-md-table-cell\">\r\n                  <i className=\"bi bi-chat-left-text me-2 fw-bolder h4\"></i>\r\n                </th>\r\n                <th>Edit</th>\r\n              </tr>\r\n            </thead>\r\n            <tbody>\r\n              {posts.map((post, index) => {\r\n                return (\r\n                  <tr className=\"my-5\" key={post._id}>\r\n                    <td className=\"d-none d-md-table-cell\">\r\n                      <span className=\"px-3 py-1 bg-info rounded text-white\">\r\n                        {index + 1}\r\n                      </span>\r\n                    </td>\r\n                    <td>\r\n                      <div className=\"d-flex align-items-center\">\r\n                        <Image\r\n                          src={post.featuredImage}\r\n                          rounded\r\n                          width=\"80px\"\r\n                          height=\"70px\"\r\n                          className=\"d-none d-md-block\"\r\n                        />\r\n\r\n                        <section className=\"ms-2\">\r\n                          <p className=\"fw-bold mb-0\">\r\n                            {post.title.slice(0, 20) + \"...\"}\r\n                          </p>\r\n                          <p className=\"mb-0\">\r\n                            {post.featuredDesc.slice(0, 40) + \"...\"}\r\n                          </p>\r\n                        </section>\r\n                      </div>\r\n                    </td>\r\n\r\n                    <td className=\"d-none d-md-table-cell\">\r\n                      <p>{post.type}</p>\r\n                    </td>\r\n                    <td className=\"d-none d-md-table-cell\">\r\n                      <p>{post.createdAt.split(\"T\")[0]}</p>\r\n                    </td>\r\n                    <td className=\"d-none d-md-table-cell\">\r\n                      <p>{post.comments.length}</p>\r\n                    </td>\r\n                    <td>\r\n                      <div className=\"d-flex flex-nowrap align-items-center justify-content-center\">\r\n                        {/* <a\r\n                          href={\"/df-dashboard/update-post/\" + post._id}\r\n                          className=\"text-black\"\r\n                        >\r\n                          <i className=\"bi bi-pencil-square fw-bolder h5\"></i>\r\n                        </a> */}\r\n\r\n                        <i\r\n                          className=\"bi bi-pencil-square fw-bolder h5\"\r\n                          style={{\r\n                            cursor: \"pointer\",\r\n                          }}\r\n                          onClick={() => {\r\n                            renderUpdatePost(post);\r\n                          }}\r\n                        ></i>\r\n\r\n                        <span\r\n                          style={{\r\n                            backgroundColor: \"#FB9195\",\r\n                            cursor: \"pointer\",\r\n                          }}\r\n                          className=\"rounded ms-1 p-1\"\r\n                        >\r\n                          <i\r\n                            className=\"bi bi-trash fw-bolder text-white h5\"\r\n                            onClick={() => {\r\n                              setDelPostId(post._id);\r\n                              handleShow();\r\n                            }}\r\n                          ></i>\r\n                        </span>\r\n                      </div>\r\n                    </td>\r\n                  </tr>\r\n                );\r\n              })}\r\n            </tbody>\r\n          </table>\r\n        </section>\r\n      ) : postsError ? (\r\n        <Alert variant=\"warning\">{postsError}</Alert>\r\n      ) : displayUpdatePost ? (\r\n        <UpdatePost post={displayUpdatePost} />\r\n      ) : (\r\n        <Loader />\r\n      )}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default Posts;\r\n","import ReactQuill from \"react-quill\";\r\nimport \"react-quill/dist/quill.snow.css\";\r\nimport React, { useState, useEffect } from \"react\";\r\nimport Form from \"react-bootstrap/Form\";\r\nimport Row from \"react-bootstrap/Row\";\r\nimport Col from \"react-bootstrap/Col\";\r\nimport Button from \"react-bootstrap/Button\";\r\nimport Alert from \"react-bootstrap/Alert\";\r\nimport Spinner from \"react-bootstrap/Spinner\";\r\nimport DatePicker from \"react-datepicker\";\r\nimport \"react-datepicker/dist/react-datepicker.css\";\r\nconst axios = require(\"axios\");\r\n\r\nconst UpdatePost = ({ post }) => {\r\n  let currentUserId = \"\";\r\n  document.cookie.split(\";\").forEach((cookie) => {\r\n    const cookieString = cookie.split(\"=\");\r\n    if (cookieString[0] === \"uid\") {\r\n      currentUserId = cookieString[1];\r\n    }\r\n  });\r\n\r\n  const [currentUser, setCurrentUser] = useState(null);\r\n  useEffect(() => {\r\n    axios.get(`/users/${currentUserId}`).then((response) => {\r\n      setCurrentUser(() => response.data.user);\r\n    });\r\n  }, [currentUserId]);\r\n\r\n  const [creator] = useState(post.createdBy);\r\n  // const [oldPostData, setOldPostData] = useState(post);\r\n  const [postBody, setPostBody] = useState(post.body);\r\n  const [submitting, setSubmitting] = useState(false);\r\n  const [postTitle, setPostTitle] = useState(post.title);\r\n  const [postType, setPostType] = useState(post.type);\r\n  const [featuredImg, setFeaturedImg] = useState(post.featuredImage);\r\n  const [audioLink, setAudioLink] = useState(post.audio);\r\n  const [featuredDesc, setFeaturedDesc] = useState(post.featuredDesc);\r\n  const [programmeDate, setProgrammeDate] = useState(\r\n    new Date(post.programmeDate)\r\n  );\r\n\r\n  const [updatePostError, setUpdatePostError] = useState(null);\r\n  const [updatedPost, setUpdatedPost] = useState(false);\r\n  const [notImage, setNotImage] = useState(false);\r\n\r\n  const sumitHandler = (e) => {\r\n    e.preventDefault();\r\n    setSubmitting(true);\r\n    let extension;\r\n    if (typeof featuredImg === \"string\") {\r\n      extension = featuredImg.split(\".\")[1].toLowerCase();\r\n    } else if (typeof featuredImg === \"object\") {\r\n      extension = featuredImg.name.split(\".\")[1].toLowerCase();\r\n    }\r\n\r\n    if (extension === \"jpg\" || extension === \"jpeg\" || extension === \"png\") {\r\n      console.log(extension);\r\n\r\n      const postData = new FormData();\r\n      postData.append(\"id\", post._id);\r\n      postData.append(\"featuredImage\", featuredImg);\r\n      postData.append(\"title\", postTitle);\r\n      postData.append(\"type\", postType);\r\n      postData.append(\"body\", postBody);\r\n      postData.append(\"audio\", audioLink !== \"\" ? audioLink : null);\r\n      postData.append(\"createdBy\", creator);\r\n      postData.append(\"featuredDesc\", featuredDesc);\r\n      postData.append(\r\n        \"pending\",\r\n        currentUser.canPublish === true ? false : true\r\n      );\r\n      postData.append(\r\n        \"programmeDate\",\r\n        programmeDate !== \"\" ? programmeDate : null\r\n      );\r\n      const config = {\r\n        headers: {\r\n          \"content-type\": \"multipart/form-data\",\r\n        },\r\n      };\r\n      axios\r\n        .post(\"/posts/update\", postData, config)\r\n        .then((response) => {\r\n          if (response.data && response.data.status) {\r\n            setUpdatedPost(true);\r\n          } else {\r\n            setUpdatePostError(\"Oops.. error updating post\");\r\n          }\r\n        })\r\n        .catch((err) => {\r\n          console.log(err);\r\n        });\r\n      setSubmitting(false);\r\n    } else {\r\n      setNotImage(true);\r\n      setSubmitting(false);\r\n      console.log(\"NOT IMG\", extension);\r\n    }\r\n  };\r\n\r\n  // Notify admins of post if created by !userCanPublish\r\n  useEffect(() => {\r\n    if (currentUser) {\r\n      if (currentUser && !currentUser.canPublish && updatedPost) {\r\n        //   const postId = oldPostData.id;\r\n        axios\r\n          .get(\"/users/\")\r\n          .then((response) => {\r\n            const adminUsers = response.data.users.filter(\r\n              (user) => user.role === \"admin\"\r\n            );\r\n            adminUsers.forEach((admin) => {\r\n              let dataObj = {\r\n                id: admin._id,\r\n                notifications: [\r\n                  ...admin.notifications,\r\n                  {\r\n                    type: \"Pending post updated\",\r\n                    body: featuredDesc.slice(0, 25),\r\n                  },\r\n                ],\r\n              };\r\n              axios\r\n                .post(\"/users/notify\", dataObj)\r\n                .then((response) => console.log(response.data))\r\n                .catch((err) => console.log(err));\r\n            });\r\n          })\r\n          .catch((err) => {\r\n            console.log(err);\r\n          });\r\n      }\r\n    }\r\n  }, [currentUser, featuredDesc, updatedPost]);\r\n\r\n  return (\r\n    <div className=\"bg-white px-1 py-4 me-md-2 my-4\">\r\n      {post.suggestion && (\r\n        <Alert variant=\"warning\">\r\n          <Alert.Heading>Changes suggested by admin</Alert.Heading>\r\n          {post.suggestion}\r\n        </Alert>\r\n      )}\r\n      {updatedPost && !updatePostError && (\r\n        <Alert variant=\"success\" className=\"my-2\">\r\n          Post updated successfully\r\n        </Alert>\r\n      )}\r\n\r\n      {updatePostError && !updatedPost && (\r\n        <Alert variant=\"danger\" className=\"my-2\">\r\n          {updatePostError}\r\n        </Alert>\r\n      )}\r\n      {!updatedPost && (\r\n        <div>\r\n          <h4 className=\"mb-4\">Update Post</h4>\r\n\r\n          <Form onSubmit={sumitHandler}>\r\n            <Row>\r\n              <Col xs={8}>\r\n                <Form.Group controlId=\"postTitle\">\r\n                  <Form.Control\r\n                    type=\"text\"\r\n                    placeholder=\"Add Title\"\r\n                    required={true}\r\n                    value={postTitle}\r\n                    name=\"postTitle\"\r\n                    onChange={(e) => setPostTitle(e.target.value)}\r\n                  />\r\n                </Form.Group>\r\n              </Col>\r\n\r\n              <Col>\r\n                <Form.Group controlId=\"postType\">\r\n                  <Form.Select\r\n                    onChange={(e) => setPostType(e.target.value)}\r\n                    required={true}\r\n                    value={postType}\r\n                    name=\"postType\"\r\n                  >\r\n                    <option value=\"\">Select Post Type</option>\r\n                    <option value=\"news\">News</option>\r\n                    <option value=\"blog\">Blog</option>\r\n                    <option value=\"sport\">Sport</option>\r\n                    <option value=\"airProgramme\">Air Programme</option>\r\n                  </Form.Select>\r\n                </Form.Group>\r\n              </Col>\r\n            </Row>\r\n\r\n            {postType === \"airProgramme\" && (\r\n              <Row className=\"mt-4\">\r\n                <Col>\r\n                  <Form.Group controlId=\"programmeDate\" className=\"mb-3\">\r\n                    <Form.Label>Select Programme Date</Form.Label>\r\n                    <DatePicker\r\n                      selected={programmeDate}\r\n                      onChange={(date) => setProgrammeDate(date)}\r\n                      showTimeSelect\r\n                      name=\"programmeDate\"\r\n                      value={programmeDate}\r\n                      timeIntervals={10}\r\n                      dateFormat=\"Pp\"\r\n                      className=\"form-control\"\r\n                    />\r\n                  </Form.Group>\r\n                </Col>\r\n\r\n                <Col>\r\n                  <Form.Group controlId=\"audioLink\" className=\"mb-3\">\r\n                    <Form.Label>Audio Link</Form.Label>\r\n                    <Form.Control\r\n                      type=\"text\"\r\n                      placeholder=\"https://streams.radiomast.io/...\"\r\n                      required={true}\r\n                      onChange={(e) => setAudioLink(e.target.value)}\r\n                      value={audioLink}\r\n                      name=\"audioLink\"\r\n                    />\r\n                  </Form.Group>\r\n                </Col>\r\n              </Row>\r\n            )}\r\n\r\n            <Row className=\"my-3\">\r\n              <Col>\r\n                <Form.Group controlId=\"featuredImage\" className=\"mb-3\">\r\n                  <Form.Label>Featured Desc</Form.Label>\r\n                  <Form.Control\r\n                    type=\"text\"\r\n                    placeholder=\"Post description\"\r\n                    required={true}\r\n                    value={featuredDesc}\r\n                    name=\"featuredDesc\"\r\n                    onChange={(e) => setFeaturedDesc(e.target.value)}\r\n                  />\r\n                </Form.Group>\r\n              </Col>\r\n              <Col>\r\n                <Form.Group controlId=\"featuredImage\" className=\"mb-3\">\r\n                  <Form.Label>Featured Image</Form.Label>\r\n                  <Form.Control\r\n                    type=\"file\"\r\n                    name=\"featuredImage\"\r\n                    accept=\"image/png,image/jpeg\"\r\n                    onChange={(e) => setFeaturedImg(e.target.files[0])}\r\n                  />\r\n                </Form.Group>\r\n                {featuredImg.length < 1 && (\r\n                  <Alert variant=\"danger\" className=\"m-1\">\r\n                    Choose featured Image\r\n                  </Alert>\r\n                )}\r\n\r\n                {notImage && (\r\n                  <Alert variant=\"danger\" className=\"my-2\">\r\n                    featured Image should be jpg, jpeg or png\r\n                  </Alert>\r\n                )}\r\n              </Col>\r\n            </Row>\r\n\r\n            <Row className=\"my-4\">\r\n              <ReactQuill\r\n                theme=\"snow\"\r\n                placeholder=\"Post Content... start writting\"\r\n                onChange={setPostBody}\r\n                value={postBody}\r\n                name=\"postBody\"\r\n              />\r\n\r\n              {postBody.length <= 11 && (\r\n                <Alert variant=\"danger\" className=\"mx-2 mt-5\">\r\n                  Add text to post\r\n                </Alert>\r\n              )}\r\n            </Row>\r\n\r\n            <Button variant=\"info\" type=\"submit\" className=\"text-white mt-5\">\r\n              {submitting ? (\r\n                <span>\r\n                  <Spinner\r\n                    as=\"span\"\r\n                    size=\"sm\"\r\n                    animation=\"border\"\r\n                    role=\"status\"\r\n                    aria-hidden=\"true\"\r\n                  />\r\n                  <span className=\"mx-1\">Creating...</span>\r\n                </span>\r\n              ) : (\r\n                <span>Update Post</span>\r\n              )}\r\n            </Button>\r\n          </Form>\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default UpdatePost;\r\n"],"sourceRoot":""}