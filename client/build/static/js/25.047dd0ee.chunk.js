(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[25],{224:function(e,t,a){"use strict";a.r(t);var c=a(39),s=a(0),n=a(41),r=a(45),l=a(76),o=a(52),i=a(18),d=a(83),j=a(1),b=a(43);t.default=function(e){var t=e.postLimit,a=Object(s.useState)(null),u=Object(c.a)(a,2),m=u[0],p=u[1],h=Object(s.useState)(null),O=Object(c.a)(h,2),x=O[0],g=O[1],f=Object(s.useState)(!1),y=Object(c.a)(f,2),v=y[0],N=y[1],w=Object(s.useState)(!1),S=Object(c.a)(w,2),C=S[0],P=S[1],D=Object(s.useState)(""),I=Object(c.a)(D,2),k=I[0],T=I[1],L=function(){return P(!1)},E=Object(s.useState)(null),A=Object(c.a)(E,2),B=A[0],G=A[1];return Object(s.useEffect)((function(){b.get("/posts").then((function(e){e.data?e.data.status?p(t?e.data.posts.reverse().filter((function(e){return"airProgramme"===e.type})).slice(0,t):e.data.posts.reverse().filter((function(e){return"airProgramme"===e.type}))):g("No post created yet... Add new"):g("Error getting posts")}))}),[t]),Object(j.jsxs)("div",{children:[Object(j.jsxs)(l.a,{show:C,onHide:L,children:[Object(j.jsx)(l.a.Header,{closeButton:!0,children:Object(j.jsx)(l.a.Title,{children:"Delete Programme"})}),Object(j.jsx)(l.a.Body,{children:"Woohoo, Do you want to delete programme?"}),Object(j.jsxs)(l.a.Footer,{children:[Object(j.jsx)(o.a,{variant:"secondary",onClick:L,children:"Not at all"}),Object(j.jsx)(o.a,{variant:"danger",onClick:function(){return e=k,N(!0),b.delete("/posts/".concat(e)).then((function(e){b.get("/posts").then((function(e){e.data?e.data.status?(N(!1),p(t?e.data.posts.reverse().filter((function(e){return"airProgramme"===e.type})).slice(0,t):e.data.posts.reverse().filter((function(e){return"airProgramme"===e.type})))):g("No post created yet... Add new"):g("Error getting posts")}))})).catch((function(e){return console.log(e)})),void L();var e},children:"Yes, delete post"})]})]}),m&&!B?Object(j.jsxs)("section",{style:{minHeight:"80px"},className:"bg-white px-3 py-4 me-md-2 my-3 rounded-3 shadow",children:[Object(j.jsx)("h4",{children:"Recent Programme"}),v&&Object(j.jsx)(i.default,{}),Object(j.jsxs)("table",{className:"table",children:[Object(j.jsx)("thead",{children:Object(j.jsxs)("tr",{children:[Object(j.jsx)("th",{className:"d-none d-md-table-cell",children:"No"}),Object(j.jsx)("th",{children:"Programme Title"}),Object(j.jsx)("th",{className:"d-none d-md-table-cell",children:"Time"}),Object(j.jsx)("th",{className:"d-none d-md-table-cell",children:"Date"}),Object(j.jsx)("th",{className:"d-none d-md-table-cell",children:Object(j.jsx)("i",{className:"bi bi-chat-left-text me-2 fw-bolder h4"})}),Object(j.jsx)("th",{children:"Edit"})]})}),Object(j.jsx)("tbody",{children:m.map((function(e,t){return Object(j.jsxs)("tr",{className:"my-5",children:[Object(j.jsx)("td",{className:"d-none d-md-table-cell",children:Object(j.jsx)("span",{className:"px-3 py-1 rounded text-white",style:{backgroundColor:"#003A70"},children:t+1})}),Object(j.jsx)("td",{children:Object(j.jsxs)("div",{className:"d-flex align-items-center",children:[Object(j.jsx)(n.a,{src:e.featuredImage,rounded:!0,width:"80px",height:"70px",className:"d-none d-md-block"}),Object(j.jsxs)("section",{className:"ms-2",children:[Object(j.jsx)("p",{className:"fw-bold mb-0",children:e.title.slice(0,20)+"..."}),Object(j.jsx)("p",{className:"mb-0",children:e.featuredDesc.slice(0,40)+"..."})]})]})}),Object(j.jsx)("td",{className:"d-none d-md-table-cell",children:Object(j.jsx)("p",{children:new Date(e.programmeDate).toLocaleTimeString("en-US")})}),Object(j.jsx)("td",{className:"d-none d-md-table-cell",children:Object(j.jsx)("p",{children:e.programmeDate.split("T")[0]})}),Object(j.jsx)("td",{className:"d-none d-md-table-cell",children:Object(j.jsx)("p",{children:e.comments.length})}),Object(j.jsx)("td",{children:Object(j.jsxs)("div",{className:"d-flex flex-nowrap align-items-center justify-content-center",children:[Object(j.jsx)("i",{className:"bi bi-pencil-square fw-bolder h5",style:{cursor:"pointer"},onClick:function(){!function(e){G(e)}(e)}}),Object(j.jsx)("span",{style:{backgroundColor:"#FB9195",cursor:"pointer"},className:"rounded ms-1 p-1",children:Object(j.jsx)("i",{className:"bi bi-trash fw-bolder text-white h5",onClick:function(){T(e._id),P(!0)}})})]})})]},e._id)}))})]})]}):x?Object(j.jsx)(r.a,{variant:"warning",children:x}):B?Object(j.jsx)(d.a,{post:B}):Object(j.jsx)(i.default,{})]})}},83:function(e,t,a){"use strict";var c=a(70),s=a(39),n=a(111),r=a.n(n),l=(a(121),a(0)),o=a(51),i=a(46),d=a(44),j=a(52),b=a(45),u=a(19),m=a(123),p=a.n(m),h=(a(122),a(1)),O=a(43);t.a=function(e){var t=e.post,a="";document.cookie.split(";").forEach((function(e){var t=e.split("=");"uid"===t[0]&&(a=t[1])}));var n=Object(l.useState)(null),m=Object(s.a)(n,2),x=m[0],g=m[1];Object(l.useEffect)((function(){O.get("/users/".concat(a)).then((function(e){g((function(){return e.data.user}))}))}),[a]);var f=Object(l.useState)(t.createdBy),y=Object(s.a)(f,1)[0],v=Object(l.useState)(t.body),N=Object(s.a)(v,2),w=N[0],S=N[1],C=Object(l.useState)(!1),P=Object(s.a)(C,2),D=P[0],I=P[1],k=Object(l.useState)(t.title),T=Object(s.a)(k,2),L=T[0],E=T[1],A=Object(l.useState)(t.type),B=Object(s.a)(A,2),G=B[0],F=B[1],q=Object(l.useState)(t.featuredImage),H=Object(s.a)(q,2),_=H[0],U=H[1],J=Object(l.useState)(t.audio),z=Object(s.a)(J,2),M=z[0],R=z[1],W=Object(l.useState)(t.featuredDesc),Y=Object(s.a)(W,2),K=Y[0],Q=Y[1],V=Object(l.useState)(new Date(t.programmeDate)),X=Object(s.a)(V,2),Z=X[0],$=X[1],ee=Object(l.useState)(null),te=Object(s.a)(ee,2),ae=te[0],ce=te[1],se=Object(l.useState)(!1),ne=Object(s.a)(se,2),re=ne[0],le=ne[1],oe=Object(l.useState)(!1),ie=Object(s.a)(oe,2),de=ie[0],je=ie[1];return Object(l.useEffect)((function(){x&&x&&!x.canPublish&&re&&O.get("/users/").then((function(e){e.data.users.filter((function(e){return"admin"===e.role})).forEach((function(e){var t={id:e._id,notifications:[].concat(Object(c.a)(e.notifications),[{type:"Pending post updated",body:K.slice(0,25)}])};O.post("/users/notify",t).then((function(e){return console.log(e.data)})).catch((function(e){return console.log(e)}))}))})).catch((function(e){console.log(e)}))}),[x,K,re]),Object(h.jsxs)("div",{className:"bg-white px-1 py-4 me-md-2 my-4",children:[t.suggestion&&Object(h.jsxs)(b.a,{variant:"warning",children:[Object(h.jsx)(b.a.Heading,{children:"Changes suggested by admin"}),t.suggestion]}),re&&!ae&&Object(h.jsx)(b.a,{variant:"success",className:"my-2",children:"Post updated successfully"}),ae&&!re&&Object(h.jsx)(b.a,{variant:"danger",className:"my-2",children:ae}),!re&&Object(h.jsxs)("div",{children:[Object(h.jsx)("h4",{className:"mb-4",children:"Update Post"}),Object(h.jsxs)(o.a,{onSubmit:function(e){var a;if(e.preventDefault(),I(!0),"string"===typeof _?a=_.split(".")[1].toLowerCase():"object"===typeof _&&(a=_.name.split(".")[1].toLowerCase()),"jpg"===a||"jpeg"===a||"png"===a){console.log(a);var c=new FormData;c.append("id",t._id),c.append("featuredImage",_),c.append("title",L),c.append("type",G),c.append("body",w),c.append("audio",""!==M?M:null),c.append("createdBy",y),c.append("featuredDesc",K),c.append("pending",!0!==x.canPublish),c.append("programmeDate",""!==Z?Z:null);O.post("/posts/update",c,{headers:{"content-type":"multipart/form-data"}}).then((function(e){e.data&&e.data.status?le(!0):ce("Oops.. error updating post")})).catch((function(e){console.log(e)})),I(!1)}else je(!0),I(!1),console.log("NOT IMG",a)},children:[Object(h.jsxs)(i.a,{children:[Object(h.jsx)(d.a,{xs:8,children:Object(h.jsx)(o.a.Group,{controlId:"postTitle",children:Object(h.jsx)(o.a.Control,{type:"text",placeholder:"Add Title",required:!0,value:L,name:"postTitle",onChange:function(e){return E(e.target.value)}})})}),Object(h.jsx)(d.a,{children:Object(h.jsx)(o.a.Group,{controlId:"postType",children:Object(h.jsxs)(o.a.Select,{onChange:function(e){return F(e.target.value)},required:!0,value:G,name:"postType",children:[Object(h.jsx)("option",{value:"",children:"Select Post Type"}),Object(h.jsx)("option",{value:"news",children:"News"}),Object(h.jsx)("option",{value:"blog",children:"Blog"}),Object(h.jsx)("option",{value:"sport",children:"Sport"}),Object(h.jsx)("option",{value:"airProgramme",children:"Air Programme"})]})})})]}),"airProgramme"===G&&Object(h.jsxs)(i.a,{className:"mt-4",children:[Object(h.jsx)(d.a,{children:Object(h.jsxs)(o.a.Group,{controlId:"programmeDate",className:"mb-3",children:[Object(h.jsx)(o.a.Label,{children:"Select Programme Date"}),Object(h.jsx)(p.a,{selected:Z,onChange:function(e){return $(e)},showTimeSelect:!0,name:"programmeDate",value:Z,timeIntervals:10,dateFormat:"Pp",className:"form-control"})]})}),Object(h.jsx)(d.a,{children:Object(h.jsxs)(o.a.Group,{controlId:"audioLink",className:"mb-3",children:[Object(h.jsx)(o.a.Label,{children:"Audio Link"}),Object(h.jsx)(o.a.Control,{type:"text",placeholder:"https://streams.radiomast.io/...",required:!0,onChange:function(e){return R(e.target.value)},value:M,name:"audioLink"})]})})]}),Object(h.jsxs)(i.a,{className:"my-3",children:[Object(h.jsx)(d.a,{children:Object(h.jsxs)(o.a.Group,{controlId:"featuredImage",className:"mb-3",children:[Object(h.jsx)(o.a.Label,{children:"Featured Desc"}),Object(h.jsx)(o.a.Control,{type:"text",placeholder:"Post description",required:!0,value:K,name:"featuredDesc",onChange:function(e){return Q(e.target.value)}})]})}),Object(h.jsxs)(d.a,{children:[Object(h.jsxs)(o.a.Group,{controlId:"featuredImage",className:"mb-3",children:[Object(h.jsx)(o.a.Label,{children:"Featured Image"}),Object(h.jsx)(o.a.Control,{type:"file",name:"featuredImage",accept:"image/png,image/jpeg",onChange:function(e){return U(e.target.files[0])}})]}),_.length<1&&Object(h.jsx)(b.a,{variant:"danger",className:"m-1",children:"Choose featured Image"}),de&&Object(h.jsx)(b.a,{variant:"danger",className:"my-2",children:"featured Image should be jpg, jpeg or png"})]})]}),Object(h.jsxs)(i.a,{className:"my-4",children:[Object(h.jsx)(r.a,{theme:"snow",placeholder:"Post Content... start writting",onChange:S,value:w,name:"postBody"}),w.length<=11&&Object(h.jsx)(b.a,{variant:"danger",className:"mx-2 mt-5",children:"Add text to post"})]}),Object(h.jsx)(j.a,{variant:"info",type:"submit",className:"text-white mt-5",children:D?Object(h.jsxs)("span",{children:[Object(h.jsx)(u.a,{as:"span",size:"sm",animation:"border",role:"status","aria-hidden":"true"}),Object(h.jsx)("span",{className:"mx-1",children:"Creating..."})]}):Object(h.jsx)("span",{children:"Update Post"})})]})]})]})}}}]);
//# sourceMappingURL=25.047dd0ee.chunk.js.map