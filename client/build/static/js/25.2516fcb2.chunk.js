(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[25],{224:function(e,t,a){"use strict";a.r(t);var c=a(39),s=a(0),n=a(41),r=a(45),l=a(74),i=a(52),o=a(18),d=a(81),j=a(1),b=a(43);t.default=function(e){var t=e.postLimit,a=Object(s.useState)(null),u=Object(c.a)(a,2),h=u[0],m=u[1],O=Object(s.useState)(null),p=Object(c.a)(O,2),x=p[0],f=p[1],g=Object(s.useState)(!1),v=Object(c.a)(g,2),y=v[0],N=v[1],w=Object(s.useState)(!1),S=Object(c.a)(w,2),C=S[0],P=S[1],D=Object(s.useState)(""),I=Object(c.a)(D,2),k=I[0],L=I[1],T=function(){return P(!1)},E=Object(s.useState)(null),A=Object(c.a)(E,2),B=A[0],F=A[1];return Object(s.useEffect)((function(){b.get("/posts").then((function(e){e.data?e.data.status?m(t?e.data.posts.reverse().filter((function(e){return"airProgramme"===e.type})).slice(0,t):e.data.posts.reverse().filter((function(e){return"airProgramme"===e.type}))):f("No post created yet... Add new"):f("Error getting posts")}))}),[t]),Object(j.jsxs)("div",{children:[Object(j.jsxs)(l.a,{show:C,onHide:T,children:[Object(j.jsx)(l.a.Header,{closeButton:!0,children:Object(j.jsx)(l.a.Title,{children:"Delete Programme"})}),Object(j.jsx)(l.a.Body,{children:"Woohoo, Do you want to delete programme?"}),Object(j.jsxs)(l.a.Footer,{children:[Object(j.jsx)(i.a,{variant:"secondary",onClick:T,children:"Not at all"}),Object(j.jsx)(i.a,{variant:"danger",onClick:function(){return e=k,N(!0),b.delete("/posts/".concat(e)).then((function(e){b.get("/posts").then((function(e){e.data?e.data.status?(N(!1),m(t?e.data.posts.reverse().filter((function(e){return"airProgramme"===e.type})).slice(0,t):e.data.posts.reverse().filter((function(e){return"airProgramme"===e.type})))):f("No post created yet... Add new"):f("Error getting posts")}))})).catch((function(e){return console.log(e)})),void T();var e},children:"Yes, delete post"})]})]}),h&&!B?Object(j.jsxs)("section",{style:{minHeight:"80px"},className:"bg-white px-3 py-4 me-md-2 my-3 rounded-3 shadow",children:[Object(j.jsx)("h4",{children:"Recent Programme"}),y&&Object(j.jsx)(o.default,{}),Object(j.jsxs)("table",{className:"table",children:[Object(j.jsx)("thead",{children:Object(j.jsxs)("tr",{children:[Object(j.jsx)("th",{className:"d-none d-md-table-cell",children:"No"}),Object(j.jsx)("th",{children:"Programme Title"}),Object(j.jsx)("th",{className:"d-none d-md-table-cell",children:"Time"}),Object(j.jsx)("th",{className:"d-none d-md-table-cell",children:"Date"}),Object(j.jsx)("th",{className:"d-none d-md-table-cell",children:Object(j.jsx)("i",{className:"bi bi-chat-left-text me-2 fw-bolder h4"})}),Object(j.jsx)("th",{children:"Edit"})]})}),Object(j.jsx)("tbody",{children:h.map((function(e,t){return Object(j.jsxs)("tr",{className:"my-5",children:[Object(j.jsx)("td",{className:"d-none d-md-table-cell",children:Object(j.jsx)("span",{className:"px-3 py-1 rounded text-white",style:{backgroundColor:"#003A70"},children:t+1})}),Object(j.jsx)("td",{children:Object(j.jsxs)("div",{className:"d-flex align-items-center",children:[Object(j.jsx)(n.a,{src:e.featuredImage,rounded:!0,width:"80px",height:"70px",className:"d-none d-md-block"}),Object(j.jsxs)("section",{className:"ms-2",children:[Object(j.jsx)("p",{className:"fw-bold mb-0",children:e.title.slice(0,20)+"..."}),Object(j.jsx)("p",{className:"mb-0",children:e.featuredDesc.slice(0,40)+"..."})]})]})}),Object(j.jsx)("td",{className:"d-none d-md-table-cell",children:Object(j.jsx)("p",{children:new Date(e.programmeDate).toLocaleTimeString("en-US")})}),Object(j.jsx)("td",{className:"d-none d-md-table-cell",children:Object(j.jsx)("p",{children:e.programmeDate.split("T")[0]})}),Object(j.jsx)("td",{className:"d-none d-md-table-cell",children:Object(j.jsx)("p",{children:e.comments.length})}),Object(j.jsx)("td",{children:Object(j.jsxs)("div",{className:"d-flex flex-nowrap align-items-center justify-content-center",children:[Object(j.jsx)("i",{className:"bi bi-pencil-square fw-bolder h5",style:{cursor:"pointer"},onClick:function(){!function(e){F(e)}(e)}}),Object(j.jsx)("span",{style:{backgroundColor:"#FB9195",cursor:"pointer"},className:"rounded ms-1 p-1",children:Object(j.jsx)("i",{className:"bi bi-trash fw-bolder text-white h5",onClick:function(){L(e._id),P(!0)}})})]})})]},e._id)}))})]})]}):x?Object(j.jsx)(r.a,{variant:"warning",children:x}):B?Object(j.jsx)(d.a,{post:B}):Object(j.jsx)(o.default,{})]})}},81:function(e,t,a){"use strict";var c=a(70),s=a(39),n=a(109),r=a.n(n),l=(a(119),a(0)),i=a(51),o=a(46),d=a(44),j=a(52),b=a(45),u=a(19),h=a(121),m=a.n(h),O=(a(120),a(1)),p=a(43);t.a=function(e){var t=e.post,a="";document.cookie.split(";").forEach((function(e){var t=e.split("=");"uid"===t[0]&&(a=t[1])}));var n=Object(l.useState)(null),h=Object(s.a)(n,2),x=h[0],f=h[1];Object(l.useEffect)((function(){p.get("/users/".concat(a)).then((function(e){f((function(){return e.data.user}))}))}),[a]);var g=Object(l.useState)(t.createdBy),v=Object(s.a)(g,1)[0],y=Object(l.useState)(t.body),N=Object(s.a)(y,2),w=N[0],S=N[1],C=Object(l.useState)(!1),P=Object(s.a)(C,2),D=P[0],I=P[1],k=Object(l.useState)(t.title),L=Object(s.a)(k,2),T=L[0],E=L[1],A=Object(l.useState)(t.type),B=Object(s.a)(A,2),F=B[0],G=B[1],q=Object(l.useState)(t.featuredImage),H=Object(s.a)(q,2),U=H[0],_=H[1],R=Object(l.useState)(t.audio),J=Object(s.a)(R,2),z=J[0],W=J[1],Y=Object(l.useState)(t.featuredDesc),K=Object(s.a)(Y,2),M=K[0],Q=K[1],V=Object(l.useState)(new Date(t.programmeDate)),X=Object(s.a)(V,2),Z=X[0],$=X[1],ee=Object(l.useState)(null),te=Object(s.a)(ee,2),ae=te[0],ce=te[1],se=Object(l.useState)(!1),ne=Object(s.a)(se,2),re=ne[0],le=ne[1];return Object(l.useEffect)((function(){x&&x&&!x.canPublish&&re&&p.get("/users/").then((function(e){e.data.users.filter((function(e){return"admin"===e.role})).forEach((function(e){var t={id:e._id,notifications:[].concat(Object(c.a)(e.notifications),[{type:"Pending post updated",body:M.slice(0,25)}])};p.post("/users/notify",t).then((function(e){return console.log(e.data)})).catch((function(e){return console.log(e)}))}))})).catch((function(e){console.log(e)}))}),[x,M,re]),Object(O.jsxs)("div",{className:"bg-white px-1 py-4 me-md-2 my-4",children:[t.suggestion&&Object(O.jsxs)(b.a,{variant:"warning",children:[Object(O.jsx)(b.a.Heading,{children:"Changes suggested by admin"}),t.suggestion]}),re&&!ae&&Object(O.jsx)(b.a,{variant:"success",className:"my-2",children:"Post updated successfully"}),ae&&!re&&Object(O.jsx)(b.a,{variant:"danger",className:"my-2",children:ae}),!re&&Object(O.jsxs)("div",{children:[Object(O.jsx)("h4",{className:"mb-4",children:"Update Post"}),Object(O.jsxs)(i.a,{onSubmit:function(e){e.preventDefault(),I(!0);var a=new FileReader,c={id:t._id,title:T,type:F,body:w,audio:""!==z?z:null,createdBy:v,featuredDesc:M,programmeDate:""!==Z?Z:null,pending:x.canPublish};"string"!==typeof U?(a.addEventListener("load",(function(){c.featuredImage=a.result,p.post("/posts/update",c).then((function(e){e.data&&e.data.status?le(!0):ce("Oops.. error updating post")})).catch((function(e){console.log(e)}))})),a.readAsDataURL(U),I(!1)):(c.featuredImage=U,p.post("/posts/update",c).then((function(e){e.data&&e.data.status?le(!0):ce("Oops.. error updating post")})).catch((function(e){console.log(e)})),I(!1))},children:[Object(O.jsxs)(o.a,{children:[Object(O.jsx)(d.a,{xs:8,children:Object(O.jsx)(i.a.Group,{controlId:"postTitle",children:Object(O.jsx)(i.a.Control,{type:"text",placeholder:"Add Title",required:!0,value:T,onChange:function(e){return E(e.target.value)}})})}),Object(O.jsx)(d.a,{children:Object(O.jsx)(i.a.Group,{controlId:"postType",children:Object(O.jsxs)(i.a.Select,{onChange:function(e){return G(e.target.value)},required:!0,value:F,children:[Object(O.jsx)("option",{value:"",children:"Select Post Type"}),Object(O.jsx)("option",{value:"news",children:"News"}),Object(O.jsx)("option",{value:"blog",children:"Blog"}),Object(O.jsx)("option",{value:"sport",children:"Sport"}),Object(O.jsx)("option",{value:"airProgramme",children:"Air Programme"})]})})})]}),"airProgramme"===F&&Object(O.jsxs)(o.a,{className:"mt-4",children:[Object(O.jsx)(d.a,{children:Object(O.jsxs)(i.a.Group,{controlId:"programmeDate",className:"mb-3",children:[Object(O.jsx)(i.a.Label,{children:"Select Programme Date"}),Object(O.jsx)(m.a,{selected:Z,onChange:function(e){return $(e)},showTimeSelect:!0,value:Z,timeIntervals:10,dateFormat:"Pp",className:"form-control"})]})}),Object(O.jsx)(d.a,{children:Object(O.jsxs)(i.a.Group,{controlId:"audioLink",className:"mb-3",children:[Object(O.jsx)(i.a.Label,{children:"Audio Link"}),Object(O.jsx)(i.a.Control,{type:"text",placeholder:"https://streams.radiomast.io/...",required:!0,onChange:function(e){return W(e.target.value)},value:z})]})})]}),Object(O.jsxs)(o.a,{className:"my-3",children:[Object(O.jsx)(d.a,{children:Object(O.jsxs)(i.a.Group,{controlId:"featuredImage",className:"mb-3",children:[Object(O.jsx)(i.a.Label,{children:"Featured Desc"}),Object(O.jsx)(i.a.Control,{type:"text",placeholder:"Post description",required:!0,value:M,onChange:function(e){return Q(e.target.value)}})]})}),Object(O.jsxs)(d.a,{children:[Object(O.jsxs)(i.a.Group,{controlId:"featuredImage",className:"mb-3",children:[Object(O.jsx)(i.a.Label,{children:"Featured Image"}),Object(O.jsx)(i.a.Control,{type:"file",onChange:function(e){return _(e.target.files[0])}})]}),U.length<1&&Object(O.jsx)(b.a,{variant:"danger",className:"m-1",children:"Choose featured Image"})]})]}),Object(O.jsxs)(o.a,{className:"my-4",children:[Object(O.jsx)(r.a,{theme:"snow",placeholder:"Post Content... start writting",onChange:S,value:w}),w.length<=11&&Object(O.jsx)(b.a,{variant:"danger",className:"mx-2 mt-5",children:"Add text to post"})]}),Object(O.jsx)(j.a,{variant:"info",type:"submit",className:"text-white mt-5",children:D?Object(O.jsxs)("span",{children:[Object(O.jsx)(u.a,{as:"span",size:"sm",animation:"border",role:"status","aria-hidden":"true"}),Object(O.jsx)("span",{className:"mx-1",children:"Creating..."})]}):Object(O.jsx)("span",{children:"Update Post"})})]})]})]})}}}]);
//# sourceMappingURL=25.2516fcb2.chunk.js.map