(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[28],{433:function(e,t,s){"use strict";s.r(t);var c=s(39),n=s(0),a=s(2),i=s(20),o=s(257),d=s(16),l=s(46),r=s(44),b=s(41),j=s(225),h=s(407),u=s(1),m=function(e){var t=e.data,s=e.cancelIcon,c=e.closeMenu,n=Object(a.f)();return Object(u.jsxs)("aside",{className:"position-fixed shadow top-0 start-0 bg-white overflow-hidden",style:{width:"230px",height:"100vh",zIndex:"10"},id:"sidebar",children:[Object(u.jsxs)("div",{className:"d-flex m-4 align-items-center",children:[Object(u.jsx)(b.a,{src:"/media/icon.png",className:"me-2"}),Object(u.jsx)("h5",{className:"fw-bolder",children:"DiamondFM"}),s&&Object(u.jsx)("i",{className:"bi bi-x-lg ms-2 fw-bolder h4",style:{cursor:"pointer"},onClick:function(){c()}})]}),Object(u.jsxs)("nav",{className:"ms-5",style:{marginTop:"60%"},children:[Object(u.jsxs)("div",{className:"d-flex my-2 align-items-center",children:[Object(u.jsx)("i",{className:"bi bi-house me-2 fw-bolder h4"}),Object(u.jsx)("a",{href:"/df-dashboard",className:"fw-bold text-decoration-none",children:"Dash"})]}),Object(u.jsxs)("div",{className:"d-flex my-2 align-items-center",children:[Object(u.jsx)("i",{className:"bi bi-file-text me-2 fw-bolder h4"}),Object(u.jsx)("a",{href:"/df-dashboard/posts",className:"fw-bold text-decoration-none",children:"Posts"})]}),Object(u.jsxs)("div",{className:"d-flex my-2 align-items-center",children:[Object(u.jsx)("i",{className:"bi bi-mic me-2 fw-bolder h4"}),Object(u.jsx)("a",{href:"/df-dashboard/programme",className:"fw-bold text-decoration-none",children:"Air Programme"})]}),Object(u.jsxs)("div",{className:"d-flex my-2 align-items-center",children:[Object(u.jsx)("i",{className:"bi bi-chat-left-text me-2 fw-bolder h4"}),Object(u.jsx)("a",{href:"/df-dashboard/comments",className:"fw-bold text-decoration-none",children:"Comments"})]}),"admin"===t.role&&Object(u.jsxs)("div",{className:"d-flex my-2 align-items-center",children:[Object(u.jsx)("i",{className:"bi bi-people me-2 fw-bolder h4"}),Object(u.jsx)("a",{href:"/df-dashboard/users",className:"fw-bold text-decoration-none",children:"Users"})]})]}),Object(u.jsxs)("section",{className:"ms-5",style:{marginTop:"30%"},children:[Object(u.jsxs)("div",{className:"d-flex my-2 align-items-center",children:[Object(u.jsx)("i",{className:"bi bi-box-arrow-left me-2 fw-bolder h4"}),Object(u.jsx)("a",{href:"/",className:"fw-bold text-decoration-none",onClick:function(e){e.preventDefault(),document.cookie.split(";").forEach((function(e){"uid"===e.split("=")[0]&&(document.cookie="uid=;expires==Thu, 01 Jan 1970 00:00:00 GMT;path=/;",n.push("/df-login"))}))},children:"Logout"})]}),Object(u.jsx)("a",{href:"/df-dashboard/create-post",className:"btn btn-info text-white",children:"NEW POST"})]})]})},f=s(70),x=s(74),p=s(52),O=s(51),g=s(43),y=function(e){var t=e.userData,s=Object(n.useState)(null),a=Object(c.a)(s,2),i=a[0],o=a[1],d=Object(n.useState)(null),l=Object(c.a)(d,2),r=l[0],j=l[1],h=Object(n.useState)(""),m=Object(c.a)(h,2),y=m[0],N=m[1];Object(n.useEffect)((function(){g.get("/posts").then((function(e){e.data?e.data.status?o(e.data.posts.reverse().filter((function(e){return!0===e.pending}))):j("No post created yet... Add new"):j("Error getting posts")}))}),[]);var v=Object(n.useState)(null),w=Object(c.a)(v,2),D=w[0],S=w[1],P=Object(n.useState)(!1),k=Object(c.a)(P,2),C=k[0],z=k[1],B=function(){return z(!1)},E=Object(n.useState)(!1),I=Object(c.a)(E,2),T=I[0],A=I[1];return Object(u.jsxs)("div",{children:[Object(u.jsxs)(x.a,{show:C,onHide:B,centered:!0,size:"lg",children:[Object(u.jsx)(x.a.Header,{closeButton:!0,children:Object(u.jsx)(x.a.Title,{children:"Post Approval"})}),Object(u.jsxs)(x.a.Body,{children:[Object(u.jsxs)("div",{className:"my-2",children:[Object(u.jsx)("p",{className:"mb-1 fw-bold",children:"Approve and Publish"}),Object(u.jsx)(p.a,{variant:"success",onClick:function(){A(!0);var e=D.title,t=D.body,s=D.type,c=D.featuredImage,n=D.featuredDesc,a=D.createdBy,d=D.audio,l=D.programmeDate,r={id:D._id,pending:!1,title:e,body:t,type:s,featuredImage:c,featuredDesc:n,createdBy:a,audio:d,programmeDate:l};g.post("/posts/update",r).then((function(e){e.data&&e.data.status?(o(i.filter((function(e){return e._id!==D._id}))),B()):console.log("Oops.. error updating post")})).catch((function(e){console.log(e)}))},children:T?"Loading...":"Publish Now"})]}),Object(u.jsxs)("div",{children:[Object(u.jsx)("p",{className:"mb-1 fw-bold",children:"Naah! suggest changes"}),Object(u.jsx)(O.a,{onSubmit:function(e){A(!0),e.preventDefault();var t=D.title,s=D.body,c=D.type,n=D.featuredImage,a=D.featuredDesc,i=D.createdBy,o=D.audio,d=D.programmeDate,l=D.pending,r={id:D._id,pending:l,title:t,body:s,type:c,featuredImage:n,featuredDesc:a,createdBy:i,audio:o,programmeDate:d,suggestion:y};g.post("/posts/update",r).then((function(e){e.data&&e.data.status?(B(),g.get("/users/".concat(D.createdBy)).then((function(e){var t={id:D.createdBy,notifications:[].concat(Object(f.a)(e.data.user.notifications),[{type:"Changes suggested",body:a.slice(0,25)}])};g.post("/users/notify",t).then((function(e){return console.log(e.data)})).catch((function(e){return console.log(e)}))}))):console.log("Oops.. error updating post")})).catch((function(e){console.log(e)}))},children:Object(u.jsxs)("div",{className:"d-flex flex-nowrap",children:[Object(u.jsx)(O.a.Group,{controlId:"postSuggestion",children:Object(u.jsx)(O.a.Control,{type:"text",placeholder:"Type here...",required:!0,value:y,onChange:function(e){return N(e.target.value)}})}),Object(u.jsx)(p.a,{variant:"danger",type:"submit",className:"ms-2",children:T?"Loading...":"Notify Editor"})]})})]})]})]}),i?Object(u.jsx)("section",{children:i.map((function(e,s){return Object(u.jsx)("section",{children:Object(u.jsxs)("div",{className:"d-flex align-items-center justify-content-between my-2",children:[Object(u.jsxs)("div",{className:"d-flex flex-nowrap align-items-center",children:[Object(u.jsx)(b.a,{src:e.featuredImage,rounded:!0,width:"80px",height:"70px"}),Object(u.jsxs)("section",{className:"ms-2",children:[Object(u.jsx)("p",{className:"fw-bold mb-0",children:e.title}),Object(u.jsx)("p",{className:"mb-0",style:{fontSize:"15px"},children:e.featuredDesc.slice(0,35)+"..."})]})]}),"admin"===t.role&&Object(u.jsx)("i",{className:"bi bi-exclamation-circle h5 text-secondary",style:{cursor:"pointer"},onClick:function(){S(e),z(!0)}})]})},s)}))}):r?Object(u.jsx)("p",{children:"No pending post"}):"loading..."]})},N=s(43),v=Object(n.lazy)((function(){return Promise.resolve().then(s.bind(null,18))})),w=Object(n.lazy)((function(){return Promise.all([s.e(3),s.e(27)]).then(s.bind(null,188))})),D=Object(n.lazy)((function(){return Promise.all([s.e(3),s.e(30)]).then(s.bind(null,428))})),S=Object(n.lazy)((function(){return Promise.all([s.e(3),s.e(25)]).then(s.bind(null,219))})),P=Object(n.lazy)((function(){return s.e(20).then(s.bind(null,429))})),k=Object(n.lazy)((function(){return Promise.all([s.e(3),s.e(19)]).then(s.bind(null,430))})),C=Object(n.lazy)((function(){return Promise.all([s.e(4),s.e(26)]).then(s.bind(null,220))})),z=Object(n.lazy)((function(){return Promise.all([s.e(4),s.e(24)]).then(s.bind(null,431))}));t.default=function(){var e="",t=Object(a.f)(),s=Object(n.useState)(null),f=Object(c.a)(s,2),x=f[0],p=f[1],O=Object(n.useState)(!1),g=Object(c.a)(O,2),B=g[0],E=g[1],I=Object(o.useMediaQuery)({query:"(min-width: 1300px)"}),T=Object(n.useState)(null),A=Object(c.a)(T,2),M=A[0],L=A[1],_=Object(n.useState)(null),H=Object(c.a)(_,2),F=H[0],J=H[1];Object(n.useEffect)((function(){N.get("/posts").then((function(e){e.data.status?L(e.data.posts.filter((function(e){return e.comments.length>0}))):J("Opps.. no comments on all posts")})).catch((function(e){return console.log(e)}))}),[]);document.cookie.split(";").forEach((function(s){var c=s.split("=");"uid"===c[0]?e=c[1]:t.push("/df-login")})),Object(n.useEffect)((function(){document.title="Dashboard | DiamondFM",N.get("/users/".concat(e)).then((function(e){e.data.status?p(e.data.user):t.push("/df-login")})).catch((function(e){console.log(e)}))}),[e,t]);var q=x&&Object(u.jsx)(j.a,{id:"popover-basic",className:"shadow bg-white border-0 rounded",children:Object(u.jsx)(j.a.Body,{children:x.notifications.length>0?Object(u.jsx)("div",{children:x.notifications.map((function(e,t){return Object(u.jsxs)("div",{children:[Object(u.jsx)("p",{className:"fw-bold mb-1",children:e.type}),Object(u.jsx)("p",{children:e.body})]},t)}))}):Object(u.jsx)("p",{children:"You have no notification"})})});return Object(u.jsx)("div",{children:x?Object(u.jsxs)("div",{children:[B&&Object(u.jsx)(m,{data:x,cancelIcon:!0,closeMenu:function(){E(!1)}}),Object(u.jsx)("section",{className:"d-none d-xl-block",children:Object(u.jsx)(m,{data:x})}),Object(u.jsxs)("main",{sm:10,style:{paddingLeft:I?"250px":"0px"},className:"mx-2",children:[Object(u.jsx)(d.a,{fluid:"lg",children:Object(u.jsxs)("header",{className:"d-flex flex-nowrap align-items-center py-2 py-lg-3 justify-content-between",children:[Object(u.jsx)("div",{className:"d-xl-none me-2",children:Object(u.jsx)("i",{className:"bi bi-list fw-bolder h3",style:{cursor:"pointer"},onClick:function(){E(!0)}})}),Object(u.jsxs)("div",{className:"bg-white px-4 py-1 shadow rounded d-flex flex-nowrap align-items-center",style:{width:"100%"},children:[Object(u.jsx)("input",{type:"text",style:{outline:"none"},className:"w-100 ps-2 border-info border-start-4 border-top-0 border-bottom-0 border-end-0",placeholder:"Search"}),Object(u.jsx)("i",{className:"bi bi-search fw-bolder h4 pe-2 d-none d-md-block"})]}),Object(u.jsx)(h.a,{trigger:"click",placement:"bottom",overlay:q,onExited:function(){var t={id:x._id,notifications:[]};N.post("/users/notify",t).then((function(t){N.get("/users/".concat(e)).then((function(e){e.data.status&&p(e.data.user)})).catch((function(e){console.log(e)}))})).catch((function(e){return console.log(e)}))},children:Object(u.jsxs)("div",{style:{cursor:"pointer"},className:"py-1 px-2 px-md-3 py-md-2 shadow bg-white rounded mx-1 mx-md-4 position-relative",children:[x.notifications.length>0&&Object(u.jsx)("span",{className:"position-absolute top-0 start-100 translate-middle p-1 p-md-2 bg-danger border border-0 rounded-circle"}),Object(u.jsx)("i",{className:"bi bi-bell-fill fw-bolder fs-6 fs-md-0 h-md-4"})]})}),Object(u.jsx)("div",{className:"ms-2",children:Object(u.jsx)("a",{href:"/df-dashboard/profile",children:Object(u.jsx)(b.a,{src:"null"!==x.avatar?x.avatar:"/media/defaultAvatar.png",roundedCircle:!0,style:{height:"45px",width:"45px"}})})})]})}),Object(u.jsx)(d.a,{fluid:"lg",children:Object(u.jsxs)(l.a,{children:[Object(u.jsx)(r.a,{lg:8,children:Object(u.jsx)(i.a,{children:Object(u.jsx)(n.Suspense,{fallback:Object(u.jsx)(v,{}),children:Object(u.jsxs)(a.c,{children:[Object(u.jsx)(a.a,{path:"/df-dashboard",exact:!0,component:k}),Object(u.jsx)(a.a,{path:"/df-dashboard/posts",component:w}),Object(u.jsx)(a.a,{path:"/df-dashboard/profile",component:C}),Object(u.jsx)(a.a,{path:"/df-dashboard/programme",component:S}),Object(u.jsx)(a.a,{path:"/df-dashboard/create-post",component:D}),Object(u.jsx)(a.a,{path:"/df-dashboard/comments",component:P}),Object(u.jsx)(a.a,{path:"/df-dashboard/users",component:z})]})})})}),Object(u.jsxs)(r.a,{children:[Object(u.jsxs)("section",{style:{minHeight:"80px"},className:"bg-white px-3 py-4 ms-md-2 my-3 rounded-3 shadow",children:[Object(u.jsx)("h4",{className:"mb-3",children:"Recent Comments"}),M?Object(u.jsx)("section",{children:M.map((function(e,t){return e.comments.map((function(e,s){return Object(u.jsx)("section",{children:Object(u.jsxs)("p",{children:[Object(u.jsx)("span",{style:{color:"#FB9195"},children:e.name})," ",Object(u.jsx)("span",{className:"text-secondary",children:"Commented"})," ",e.body]})},t)}))}))}):F?{postsError:F}:"Loading..."]}),Object(u.jsxs)("section",{style:{minHeight:"80px"},className:"bg-white px-3 py-4 ms-md-2 my-4 rounded shadow",children:[Object(u.jsxs)("h4",{className:"mb-3",children:["Pending ","admin"===x.role?"Posts":"Approval"]}),Object(u.jsx)(y,{userData:x})]})]})]})})]})]}):Object(u.jsx)(v,{})})}}}]);
//# sourceMappingURL=28.9da86a1c.chunk.js.map